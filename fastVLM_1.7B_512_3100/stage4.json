{
  "description": "FastViTHD stage4 attention, layers=4, embeds=768",
  "tensors": [


    { "name": "s4_tokens",     "shape": [256, 768],        "bits": 16, "device": "dram", "layer": 4},
    { "name": "s4_norm",       "shape": [256, 768],        "bits": 16, "device": "dram", "layer": 4},

    { "name": "attn_ctx_cat_s4", "shape": [256, 768], "bits": 16, "device": "dram", "layer": 4},
    { "name": "attn_out_s4",     "shape": [256, 768], "bits": 16, "device": "dram", "layer": 4},
    { "name": "W_o_s4",          "shape": [768, 768], "bits": 4, "device": "dram", "layer": 4},

    { "name": "W_q4_h1",  "shape": [768, 64], "bits": 4, "device": "dram", "layer": 4}, { "name": "W_k4_h1",  "shape": [768, 64], "bits": 4, "device": "dram", "layer": 4}, { "name": "W_v4_h1",  "shape": [768, 64], "bits": 4, "device": "dram", "layer": 4},
    { "name": "W_q4_h2",  "shape": [768, 64], "bits": 4, "device": "dram", "layer": 4}, { "name": "W_k4_h2",  "shape": [768, 64], "bits": 4, "device": "dram", "layer": 4}, { "name": "W_v4_h2",  "shape": [768, 64], "bits": 4, "device": "dram", "layer": 4},
    { "name": "W_q4_h3",  "shape": [768, 64], "bits": 4, "device": "dram", "layer": 4}, { "name": "W_k4_h3",  "shape": [768, 64], "bits": 4, "device": "dram", "layer": 4}, { "name": "W_v4_h3",  "shape": [768, 64], "bits": 4, "device": "dram", "layer": 4},
    { "name": "W_q4_h4",  "shape": [768, 64], "bits": 4, "device": "dram", "layer": 4}, { "name": "W_k4_h4",  "shape": [768, 64], "bits": 4, "device": "dram", "layer": 4}, { "name": "W_v4_h4",  "shape": [768, 64], "bits": 4, "device": "dram", "layer": 4},
    { "name": "W_q4_h5",  "shape": [768, 64], "bits": 4, "device": "dram", "layer": 4}, { "name": "W_k4_h5",  "shape": [768, 64], "bits": 4, "device": "dram", "layer": 4}, { "name": "W_v4_h5",  "shape": [768, 64], "bits": 4, "device": "dram", "layer": 4},
    { "name": "W_q4_h6",  "shape": [768, 64], "bits": 4, "device": "dram", "layer": 4}, { "name": "W_k4_h6",  "shape": [768, 64], "bits": 4, "device": "dram", "layer": 4}, { "name": "W_v4_h6",  "shape": [768, 64], "bits": 4, "device": "dram", "layer": 4},
    { "name": "W_q4_h7",  "shape": [768, 64], "bits": 4, "device": "dram", "layer": 4}, { "name": "W_k4_h7",  "shape": [768, 64], "bits": 4, "device": "dram", "layer": 4}, { "name": "W_v4_h7",  "shape": [768, 64], "bits": 4, "device": "dram", "layer": 4},
    { "name": "W_q4_h8",  "shape": [768, 64], "bits": 4, "device": "dram", "layer": 4}, { "name": "W_k4_h8",  "shape": [768, 64], "bits": 4, "device": "dram", "layer": 4}, { "name": "W_v4_h8",  "shape": [768, 64], "bits": 4, "device": "dram", "layer": 4},
    { "name": "W_q4_h9",  "shape": [768, 64], "bits": 4, "device": "dram", "layer": 4}, { "name": "W_k4_h9",  "shape": [768, 64], "bits": 4, "device": "dram", "layer": 4}, { "name": "W_v4_h9",  "shape": [768, 64], "bits": 4, "device": "dram", "layer": 4},
    { "name": "W_q4_h10", "shape": [768, 64], "bits": 4, "device": "dram", "layer": 4}, { "name": "W_k4_h10", "shape": [768, 64], "bits": 4, "device": "dram", "layer": 4}, { "name": "W_v4_h10","shape": [768, 64], "bits": 4, "device": "dram", "layer": 4},
    { "name": "W_q4_h11", "shape": [768, 64], "bits": 4, "device": "dram", "layer": 4}, { "name": "W_k4_h11", "shape": [768, 64], "bits": 4, "device": "dram", "layer": 4}, { "name": "W_v4_h11","shape": [768, 64], "bits": 4, "device": "dram", "layer": 4},
    { "name": "W_q4_h12", "shape": [768, 64], "bits": 4, "device": "dram", "layer": 4}, { "name": "W_k4_h12", "shape": [768, 64], "bits": 4, "device": "dram", "layer": 4}, { "name": "W_v4_h12","shape": [768, 64], "bits": 4, "device": "dram", "layer": 4},

    { "name": "Q4_h1", "shape": [256, 64], "bits": 16, "device": "dram", "layer": 4}, { "name": "K4_h1", "shape": [256, 64], "bits": 16, "device": "dram", "layer": 4}, { "name": "V4_h1", "shape": [256, 64], "bits": 16, "device": "dram", "layer": 4},
    { "name": "Q4_h2", "shape": [256, 64], "bits": 16, "device": "dram", "layer": 4}, { "name": "K4_h2", "shape": [256, 64], "bits": 16, "device": "dram", "layer": 4}, { "name": "V4_h2", "shape": [256, 64], "bits": 16, "device": "dram", "layer": 4},
    { "name": "Q4_h3", "shape": [256, 64], "bits": 16, "device": "dram", "layer": 4}, { "name": "K4_h3", "shape": [256, 64], "bits": 16, "device": "dram", "layer": 4}, { "name": "V4_h3", "shape": [256, 64], "bits": 16, "device": "dram", "layer": 4},
    { "name": "Q4_h4", "shape": [256, 64], "bits": 16, "device": "dram", "layer": 4}, { "name": "K4_h4", "shape": [256, 64], "bits": 16, "device": "dram", "layer": 4}, { "name": "V4_h4", "shape": [256, 64], "bits": 16, "device": "dram", "layer": 4},
    { "name": "Q4_h5", "shape": [256, 64], "bits": 16, "device": "dram", "layer": 4}, { "name": "K4_h5", "shape": [256, 64], "bits": 16, "device": "dram", "layer": 4}, { "name": "V4_h5", "shape": [256, 64], "bits": 16, "device": "dram", "layer": 4},
    { "name": "Q4_h6", "shape": [256, 64], "bits": 16, "device": "dram", "layer": 4}, { "name": "K4_h6", "shape": [256, 64], "bits": 16, "device": "dram", "layer": 4}, { "name": "V4_h6", "shape": [256, 64], "bits": 16, "device": "dram", "layer": 4},
    { "name": "Q4_h7", "shape": [256, 64], "bits": 16, "device": "dram", "layer": 4}, { "name": "K4_h7", "shape": [256, 64], "bits": 16, "device": "dram", "layer": 4}, { "name": "V4_h7", "shape": [256, 64], "bits": 16, "device": "dram", "layer": 4},
    { "name": "Q4_h8", "shape": [256, 64], "bits": 16, "device": "dram", "layer": 4}, { "name": "K4_h8", "shape": [256, 64], "bits": 16, "device": "dram", "layer": 4}, { "name": "V4_h8", "shape": [256, 64], "bits": 16, "device": "dram", "layer": 4},
    { "name": "Q4_h9", "shape": [256, 64], "bits": 16, "device": "dram", "layer": 4}, { "name": "K4_h9", "shape": [256, 64], "bits": 16, "device": "dram", "layer": 4}, { "name": "V4_h9", "shape": [256, 64], "bits": 16, "device": "dram", "layer": 4},
    { "name": "Q4_h10","shape": [256, 64], "bits": 16, "device": "dram", "layer": 4}, { "name": "K4_h10","shape": [256, 64], "bits": 16, "device": "dram", "layer": 4}, { "name": "V4_h10","shape": [256, 64], "bits": 16, "device": "dram", "layer": 4},
    { "name": "Q4_h11","shape": [256, 64], "bits": 16, "device": "dram", "layer": 4}, { "name": "K4_h11","shape": [256, 64], "bits": 16, "device": "dram", "layer": 4}, { "name": "V4_h11","shape": [256, 64], "bits": 16, "device": "dram", "layer": 4},
    { "name": "Q4_h12","shape": [256, 64], "bits": 16, "device": "dram", "layer": 4}, { "name": "K4_h12","shape": [256, 64], "bits": 16, "device": "dram", "layer": 4}, { "name": "V4_h12","shape": [256, 64], "bits": 16, "device": "dram", "layer": 4},

    { "name": "attn_scores4_h1", "shape": [256, 256], "bits": 16, "device": "dram", "layer": 4}, { "name": "attn_probs4_h1", "shape": [256, 256], "bits": 16, "device": "dram", "layer": 4}, { "name": "attn_ctx4_h1", "shape": [256, 64], "bits": 16, "device": "dram", "layer": 4},
    { "name": "attn_scores4_h2", "shape": [256, 256], "bits": 16, "device": "dram", "layer": 4}, { "name": "attn_probs4_h2", "shape": [256, 256], "bits": 16, "device": "dram", "layer": 4}, { "name": "attn_ctx4_h2", "shape": [256, 64], "bits": 16, "device": "dram", "layer": 4},
    { "name": "attn_scores4_h3", "shape": [256, 256], "bits": 16, "device": "dram", "layer": 4}, { "name": "attn_probs4_h3", "shape": [256, 256], "bits": 16, "device": "dram", "layer": 4}, { "name": "attn_ctx4_h3", "shape": [256, 64], "bits": 16, "device": "dram", "layer": 4},
    { "name": "attn_scores4_h4", "shape": [256, 256], "bits": 16, "device": "dram", "layer": 4}, { "name": "attn_probs4_h4", "shape": [256, 256], "bits": 16, "device": "dram", "layer": 4}, { "name": "attn_ctx4_h4", "shape": [256, 64], "bits": 16, "device": "dram", "layer": 4},
    { "name": "attn_scores4_h5", "shape": [256, 256], "bits": 16, "device": "dram", "layer": 4}, { "name": "attn_probs4_h5", "shape": [256, 256], "bits": 16, "device": "dram", "layer": 4}, { "name": "attn_ctx4_h5", "shape": [256, 64], "bits": 16, "device": "dram", "layer": 4},
    { "name": "attn_scores4_h6", "shape": [256, 256], "bits": 16, "device": "dram", "layer": 4}, { "name": "attn_probs4_h6", "shape": [256, 256], "bits": 16, "device": "dram", "layer": 4}, { "name": "attn_ctx4_h6", "shape": [256, 64], "bits": 16, "device": "dram", "layer": 4},
    { "name": "attn_scores4_h7", "shape": [256, 256], "bits": 16, "device": "dram", "layer": 4}, { "name": "attn_probs4_h7", "shape": [256, 256], "bits": 16, "device": "dram", "layer": 4}, { "name": "attn_ctx4_h7", "shape": [256, 64], "bits": 16, "device": "dram", "layer": 4},
    { "name": "attn_scores4_h8", "shape": [256, 256], "bits": 16, "device": "dram", "layer": 4}, { "name": "attn_probs4_h8", "shape": [256, 256], "bits": 16, "device": "dram", "layer": 4}, { "name": "attn_ctx4_h8", "shape": [256, 64], "bits": 16, "device": "dram", "layer": 4},
    { "name": "attn_scores4_h9", "shape": [256, 256], "bits": 16, "device": "dram", "layer": 4}, { "name": "attn_probs4_h9", "shape": [256, 256], "bits": 16, "device": "dram", "layer": 4}, { "name": "attn_ctx4_h9", "shape": [256, 64], "bits": 16, "device": "dram", "layer": 4},
    { "name": "attn_scores4_h10","shape": [256, 256], "bits": 16, "device": "dram", "layer": 4}, { "name": "attn_probs4_h10","shape": [256, 256], "bits": 16, "device": "dram", "layer": 4}, { "name": "attn_ctx4_h10","shape": [256, 64], "bits": 16, "device": "dram", "layer": 4},
    { "name": "attn_scores4_h11","shape": [256, 256], "bits": 16, "device": "dram", "layer": 4}, { "name": "attn_probs4_h11","shape": [256, 256], "bits": 16, "device": "dram", "layer": 4}, { "name": "attn_ctx4_h11","shape": [256, 64], "bits": 16, "device": "dram", "layer": 4},
    { "name": "attn_scores4_h12","shape": [256, 256], "bits": 16, "device": "dram", "layer": 4}, { "name": "attn_probs4_h12","shape": [256, 256], "bits": 16, "device": "dram", "layer": 4}, { "name": "attn_ctx4_h12","shape": [256, 64], "bits": 16, "device": "dram", "layer": 4}
  ],

  "ops": [

    { "type": "LayerNorm", "A": "s4_tokens", "C": "s4_norm" },

    { "type": "ParallelOps", "branches": [
      { "type": "MatMul", "A": "s4_norm", "B": "W_q4_h1",  "C": "Q4_h1" },
      { "type": "MatMul", "A": "s4_norm", "B": "W_k4_h1",  "C": "K4_h1" },
      { "type": "MatMul", "A": "s4_norm", "B": "W_v4_h1",  "C": "V4_h1" },

      { "type": "MatMul", "A": "s4_norm", "B": "W_q4_h2",  "C": "Q4_h2" },
      { "type": "MatMul", "A": "s4_norm", "B": "W_k4_h2",  "C": "K4_h2" },
      { "type": "MatMul", "A": "s4_norm", "B": "W_v4_h2",  "C": "V4_h2" },

      { "type": "MatMul", "A": "s4_norm", "B": "W_q4_h3",  "C": "Q4_h3" },
      { "type": "MatMul", "A": "s4_norm", "B": "W_k4_h3",  "C": "K4_h3" },
      { "type": "MatMul", "A": "s4_norm", "B": "W_v4_h3",  "C": "V4_h3" },

      { "type": "MatMul", "A": "s4_norm", "B": "W_q4_h4",  "C": "Q4_h4" },
      { "type": "MatMul", "A": "s4_norm", "B": "W_k4_h4",  "C": "K4_h4" },
      { "type": "MatMul", "A": "s4_norm", "B": "W_v4_h4",  "C": "V4_h4" },

      { "type": "MatMul", "A": "s4_norm", "B": "W_q4_h5",  "C": "Q4_h5" },
      { "type": "MatMul", "A": "s4_norm", "B": "W_k4_h5",  "C": "K4_h5" },
      { "type": "MatMul", "A": "s4_norm", "B": "W_v4_h5",  "C": "V4_h5" },

      { "type": "MatMul", "A": "s4_norm", "B": "W_q4_h6",  "C": "Q4_h6" },
      { "type": "MatMul", "A": "s4_norm", "B": "W_k4_h6",  "C": "K4_h6" },
      { "type": "MatMul", "A": "s4_norm", "B": "W_v4_h6",  "C": "V4_h6" },

      { "type": "MatMul", "A": "s4_norm", "B": "W_q4_h7",  "C": "Q4_h7" },
      { "type": "MatMul", "A": "s4_norm", "B": "W_k4_h7",  "C": "K4_h7" },
      { "type": "MatMul", "A": "s4_norm", "B": "W_v4_h7",  "C": "V4_h7" },

      { "type": "MatMul", "A": "s4_norm", "B": "W_q4_h8",  "C": "Q4_h8" },
      { "type": "MatMul", "A": "s4_norm", "B": "W_k4_h8",  "C": "K4_h8" },
      { "type": "MatMul", "A": "s4_norm", "B": "W_v4_h8",  "C": "V4_h8" },

      { "type": "MatMul", "A": "s4_norm", "B": "W_q4_h9",  "C": "Q4_h9" },
      { "type": "MatMul", "A": "s4_norm", "B": "W_k4_h9",  "C": "K4_h9" },
      { "type": "MatMul", "A": "s4_norm", "B": "W_v4_h9",  "C": "V4_h9" },

      { "type": "MatMul", "A": "s4_norm", "B": "W_q4_h10", "C": "Q4_h10" },
      { "type": "MatMul", "A": "s4_norm", "B": "W_k4_h10", "C": "K4_h10" },
      { "type": "MatMul", "A": "s4_norm", "B": "W_v4_h10", "C": "V4_h10" },

      { "type": "MatMul", "A": "s4_norm", "B": "W_q4_h11", "C": "Q4_h11" },
      { "type": "MatMul", "A": "s4_norm", "B": "W_k4_h11", "C": "K4_h11" },
      { "type": "MatMul", "A": "s4_norm", "B": "W_v4_h11", "C": "V4_h11" },

      { "type": "MatMul", "A": "s4_norm", "B": "W_q4_h12", "C": "Q4_h12" },
      { "type": "MatMul", "A": "s4_norm", "B": "W_k4_h12", "C": "K4_h12" },
      { "type": "MatMul", "A": "s4_norm", "B": "W_v4_h12", "C": "V4_h12" }
    ]},

    { "type": "ParallelOps", "branches": [
      { "type": "MatMul", "A": "Q4_h1",  "B": "K4_h1",  "C": "attn_scores4_h1",  "transpose_B": true },
      { "type": "MatMul", "A": "Q4_h2",  "B": "K4_h2",  "C": "attn_scores4_h2",  "transpose_B": true },
      { "type": "MatMul", "A": "Q4_h3",  "B": "K4_h3",  "C": "attn_scores4_h3",  "transpose_B": true },
      { "type": "MatMul", "A": "Q4_h4",  "B": "K4_h4",  "C": "attn_scores4_h4",  "transpose_B": true },
      { "type": "MatMul", "A": "Q4_h5",  "B": "K4_h5",  "C": "attn_scores4_h5",  "transpose_B": true },
      { "type": "MatMul", "A": "Q4_h6",  "B": "K4_h6",  "C": "attn_scores4_h6",  "transpose_B": true },
      { "type": "MatMul", "A": "Q4_h7",  "B": "K4_h7",  "C": "attn_scores4_h7",  "transpose_B": true },
      { "type": "MatMul", "A": "Q4_h8",  "B": "K4_h8",  "C": "attn_scores4_h8",  "transpose_B": true },
      { "type": "MatMul", "A": "Q4_h9",  "B": "K4_h9",  "C": "attn_scores4_h9",  "transpose_B": true },
      { "type": "MatMul", "A": "Q4_h10", "B": "K4_h10", "C": "attn_scores4_h10", "transpose_B": true },
      { "type": "MatMul", "A": "Q4_h11", "B": "K4_h11", "C": "attn_scores4_h11", "transpose_B": true },
      { "type": "MatMul", "A": "Q4_h12", "B": "K4_h12", "C": "attn_scores4_h12", "transpose_B": true }
    ]},
    { "type": "ParallelOps", "branches": [
      { "type": "SoftmaxOp", "A": "attn_scores4_h1",  "axis": -1, "C": "attn_probs4_h1"  },
      { "type": "SoftmaxOp", "A": "attn_scores4_h2",  "axis": -1, "C": "attn_probs4_h2"  },
      { "type": "SoftmaxOp", "A": "attn_scores4_h3",  "axis": -1, "C": "attn_probs4_h3"  },
      { "type": "SoftmaxOp", "A": "attn_scores4_h4",  "axis": -1, "C": "attn_probs4_h4"  },
      { "type": "SoftmaxOp", "A": "attn_scores4_h5",  "axis": -1, "C": "attn_probs4_h5"  },
      { "type": "SoftmaxOp", "A": "attn_scores4_h6",  "axis": -1, "C": "attn_probs4_h6"  },
      { "type": "SoftmaxOp", "A": "attn_scores4_h7",  "axis": -1, "C": "attn_probs4_h7"  },
      { "type": "SoftmaxOp", "A": "attn_scores4_h8",  "axis": -1, "C": "attn_probs4_h8"  },
      { "type": "SoftmaxOp", "A": "attn_scores4_h9",  "axis": -1, "C": "attn_probs4_h9"  },
      { "type": "SoftmaxOp", "A": "attn_scores4_h10", "axis": -1, "C": "attn_probs4_h10" },
      { "type": "SoftmaxOp", "A": "attn_scores4_h11", "axis": -1, "C": "attn_probs4_h11" },
      { "type": "SoftmaxOp", "A": "attn_scores4_h12", "axis": -1, "C": "attn_probs4_h12" }
    ]},
    { "type": "ParallelOps", "branches": [
      { "type": "MatMul", "A": "attn_probs4_h1",  "B": "V4_h1",  "C": "attn_ctx4_h1"  },
      { "type": "MatMul", "A": "attn_probs4_h2",  "B": "V4_h2",  "C": "attn_ctx4_h2"  },
      { "type": "MatMul", "A": "attn_probs4_h3",  "B": "V4_h3",  "C": "attn_ctx4_h3"  },
      { "type": "MatMul", "A": "attn_probs4_h4",  "B": "V4_h4",  "C": "attn_ctx4_h4"  },
      { "type": "MatMul", "A": "attn_probs4_h5",  "B": "V4_h5",  "C": "attn_ctx4_h5"  },
      { "type": "MatMul", "A": "attn_probs4_h6",  "B": "V4_h6",  "C": "attn_ctx4_h6"  },
      { "type": "MatMul", "A": "attn_probs4_h7",  "B": "V4_h7",  "C": "attn_ctx4_h7"  },
      { "type": "MatMul", "A": "attn_probs4_h8",  "B": "V4_h8",  "C": "attn_ctx4_h8"  },
      { "type": "MatMul", "A": "attn_probs4_h9",  "B": "V4_h9",  "C": "attn_ctx4_h9"  },
      { "type": "MatMul", "A": "attn_probs4_h10", "B": "V4_h10", "C": "attn_ctx4_h10" },
      { "type": "MatMul", "A": "attn_probs4_h11", "B": "V4_h11", "C": "attn_ctx4_h11" },
      { "type": "MatMul", "A": "attn_probs4_h12", "B": "V4_h12", "C": "attn_ctx4_h12" }
    ]},

    { "type": "MatMul", "A": "attn_ctx_cat_s4", "B": "W_o_s4", "C": "attn_out_s4" }

  ]
}
