{
  "description": "MobileLLaMA1.4B decoding step #1 (single layer, 24 layers total), 16 heads, 2048 dim. Use middle-stage KV cache (output_tokens_len=448, context_len=324+2100+488/2=2668). (Attn&weights&KV @dram, FFN weights @rram)",
  "tensors": [
    {"name": "token_pe_cur", "shape": [1, 2048], "bits": 16, "device": "dram", "layer": 5},

    {"name": "W_q_0_h1",  "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_k_0_h1",  "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_v_0_h1",  "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_q_0_h2",  "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_k_0_h2",  "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_v_0_h2",  "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_q_0_h3",  "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_k_0_h3",  "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_v_0_h3",  "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_q_0_h4",  "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_k_0_h4",  "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_v_0_h4",  "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_q_0_h5",  "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_k_0_h5",  "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_v_0_h5",  "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_q_0_h6",  "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_k_0_h6",  "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_v_0_h6",  "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_q_0_h7",  "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_k_0_h7",  "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_v_0_h7",  "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_q_0_h8",  "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_k_0_h8",  "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_v_0_h8",  "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_q_0_h9",  "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_k_0_h9",  "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_v_0_h9",  "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_q_0_h10", "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_k_0_h10", "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_v_0_h10", "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_q_0_h11", "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_k_0_h11", "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_v_0_h11", "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_q_0_h12", "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_k_0_h12", "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_v_0_h12", "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_q_0_h13", "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_k_0_h13", "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_v_0_h13", "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_q_0_h14", "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_k_0_h14", "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_v_0_h14", "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_q_0_h15", "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_k_0_h15", "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_v_0_h15", "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_q_0_h16", "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_k_0_h16", "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},
    {"name": "W_v_0_h16", "shape": [2048, 128], "bits": 4, "device": "dram", "layer": 5},

    {"name": "W_o_0", "shape": [2048, 2048], "bits": 4, "device": "dram", "layer": 5},


    {"name": "K_cache_h1",  "shape": [2668, 128], "bits": 16, "device": "dram", "layer": 1},
    {"name": "V_cache_h1",  "shape": [2668, 128], "bits": 16, "device": "dram", "layer": 1},
    {"name": "K_cache_h2",  "shape": [2668, 128], "bits": 16, "device": "dram", "layer": 1},
    {"name": "V_cache_h2",  "shape": [2668, 128], "bits": 16, "device": "dram", "layer": 1},
    {"name": "K_cache_h3",  "shape": [2668, 128], "bits": 16, "device": "dram", "layer": 1},
    {"name": "V_cache_h3",  "shape": [2668, 128], "bits": 16, "device": "dram", "layer": 1},
    {"name": "K_cache_h4",  "shape": [2668, 128], "bits": 16, "device": "dram", "layer": 1},
    {"name": "V_cache_h4",  "shape": [2668, 128], "bits": 16, "device": "dram", "layer": 1},
    {"name": "K_cache_h5",  "shape": [2668, 128], "bits": 16, "device": "dram", "layer": 1},
    {"name": "V_cache_h5",  "shape": [2668, 128], "bits": 16, "device": "dram", "layer": 1},
    {"name": "K_cache_h6",  "shape": [2668, 128], "bits": 16, "device": "dram", "layer": 1},
    {"name": "V_cache_h6",  "shape": [2668, 128], "bits": 16, "device": "dram", "layer": 1},
    {"name": "K_cache_h7",  "shape": [2668, 128], "bits": 16, "device": "dram", "layer": 1},
    {"name": "V_cache_h7",  "shape": [2668, 128], "bits": 16, "device": "dram", "layer": 1},
    {"name": "K_cache_h8",  "shape": [2668, 128], "bits": 16, "device": "dram", "layer": 1},
    {"name": "V_cache_h8",  "shape": [2668, 128], "bits": 16, "device": "dram", "layer": 1},
    {"name": "K_cache_h9",  "shape": [2668, 128], "bits": 16, "device": "dram", "layer": 1},
    {"name": "V_cache_h9",  "shape": [2668, 128], "bits": 16, "device": "dram", "layer": 1},
    {"name": "K_cache_h10", "shape": [2668, 128], "bits": 16, "device": "dram", "layer": 1},
    {"name": "V_cache_h10", "shape": [2668, 128], "bits": 16, "device": "dram", "layer": 1},
    {"name": "K_cache_h11", "shape": [2668, 128], "bits": 16, "device": "dram", "layer": 1},
    {"name": "V_cache_h11", "shape": [2668, 128], "bits": 16, "device": "dram", "layer": 1},
    {"name": "K_cache_h12", "shape": [2668, 128], "bits": 16, "device": "dram", "layer": 1},
    {"name": "V_cache_h12", "shape": [2668, 128], "bits": 16, "device": "dram", "layer": 1},
    {"name": "K_cache_h13", "shape": [2668, 128], "bits": 16, "device": "dram", "layer": 1},
    {"name": "V_cache_h13", "shape": [2668, 128], "bits": 16, "device": "dram", "layer": 1},
    {"name": "K_cache_h14", "shape": [2668, 128], "bits": 16, "device": "dram", "layer": 1},
    {"name": "V_cache_h14", "shape": [2668, 128], "bits": 16, "device": "dram", "layer": 1},
    {"name": "K_cache_h15", "shape": [2668, 128], "bits": 16, "device": "dram", "layer": 1},
    {"name": "V_cache_h15", "shape": [2668, 128], "bits": 16, "device": "dram", "layer": 1},
    {"name": "K_cache_h16", "shape": [2668, 128], "bits": 16, "device": "dram", "layer": 1},
    {"name": "V_cache_h16", "shape": [2668, 128], "bits": 16, "device": "dram", "layer": 1},


    {"name": "Q_t_h1",  "shape": [1, 128], "bits": 16, "device": "dram", "layer": 1},
    {"name": "K_t_h1",  "shape": [1, 128], "bits": 16, "device": "dram", "layer": 1},
    {"name": "V_t_h1",  "shape": [1, 128], "bits": 16, "device": "dram", "layer": 1},
    {"name": "Q_t_h2",  "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},
    {"name": "K_t_h2",  "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},
    {"name": "V_t_h2",  "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},
    {"name": "Q_t_h3",  "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},
    {"name": "K_t_h3",  "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},
    {"name": "V_t_h3",  "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},
    {"name": "Q_t_h4",  "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},
    {"name": "K_t_h4",  "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},
    {"name": "V_t_h4",  "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},
    {"name": "Q_t_h5",  "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},
    {"name": "K_t_h5",  "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},
    {"name": "V_t_h5",  "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},
    {"name": "Q_t_h6",  "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},
    {"name": "K_t_h6",  "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},
    {"name": "V_t_h6",  "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},
    {"name": "Q_t_h7",  "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},
    {"name": "K_t_h7",  "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},
    {"name": "V_t_h7",  "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},
    {"name": "Q_t_h8",  "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},
    {"name": "K_t_h8",  "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},
    {"name": "V_t_h8",  "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},
    {"name": "Q_t_h9",  "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},
    {"name": "K_t_h9",  "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},
    {"name": "V_t_h9",  "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},
    {"name": "Q_t_h10", "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},
    {"name": "K_t_h10", "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},
    {"name": "V_t_h10", "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},
    {"name": "Q_t_h11", "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},
    {"name": "K_t_h11", "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},
    {"name": "V_t_h11", "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},
    {"name": "Q_t_h12", "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},
    {"name": "K_t_h12", "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},
    {"name": "V_t_h12", "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},
    {"name": "Q_t_h13", "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},
    {"name": "K_t_h13", "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},
    {"name": "V_t_h13", "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},
    {"name": "Q_t_h14", "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},
    {"name": "K_t_h14", "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},
    {"name": "V_t_h14", "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},
    {"name": "Q_t_h15", "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},
    {"name": "K_t_h15", "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},
    {"name": "V_t_h15", "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},
    {"name": "Q_t_h16", "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},
    {"name": "K_t_h16", "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},
    {"name": "V_t_h16", "shape": [1,128],  "bits": 16, "device": "dram", "layer": 1},

    {"name": "attn_scores_h1", "shape": [1,2668], "bits": 16, "device": "dram", "layer": 2},
    {"name": "attn_probs_h1",  "shape": [1,2668], "bits": 16, "device": "dram", "layer": 2},
    {"name": "attn_ctx_h1",    "shape": [1,128],  "bits": 16, "device": "dram", "layer": 2},

    {"name": "attn_scores_h2", "shape": [1,2668], "bits": 16, "device": "dram", "layer": 2},
    {"name": "attn_probs_h2",  "shape": [1,2668], "bits": 16, "device": "dram", "layer": 2},
    {"name": "attn_ctx_h2",    "shape": [1,128],  "bits": 16, "device": "dram", "layer": 2},

    {"name": "attn_scores_h3", "shape": [1,2668], "bits": 16, "device": "dram", "layer": 2},
    {"name": "attn_probs_h3",  "shape": [1,2668], "bits": 16, "device": "dram", "layer": 2},
    {"name": "attn_ctx_h3",    "shape": [1,128],  "bits": 16, "device": "dram", "layer": 2},

    {"name": "attn_scores_h4", "shape": [1,2668], "bits": 16, "device": "dram", "layer": 2},
    {"name": "attn_probs_h4",  "shape": [1,2668], "bits": 16, "device": "dram", "layer": 2},
    {"name": "attn_ctx_h4",    "shape": [1,128],  "bits": 16, "device": "dram", "layer": 2},

    {"name": "attn_scores_h5", "shape": [1,2668], "bits": 16, "device": "dram", "layer": 2},
    {"name": "attn_probs_h5",  "shape": [1,2668], "bits": 16, "device": "dram", "layer": 2},
    {"name": "attn_ctx_h5",    "shape": [1,128],  "bits": 16, "device": "dram", "layer": 2},

    {"name": "attn_scores_h6", "shape": [1,2668], "bits": 16, "device": "dram", "layer": 2},
    {"name": "attn_probs_h6",  "shape": [1,2668], "bits": 16, "device": "dram", "layer": 2},
    {"name": "attn_ctx_h6",    "shape": [1,128],  "bits": 16, "device": "dram", "layer": 2},

    {"name": "attn_scores_h7", "shape": [1,2668], "bits": 16, "device": "dram", "layer": 2},
    {"name": "attn_probs_h7",  "shape": [1,2668], "bits": 16, "device": "dram", "layer": 2},
    {"name": "attn_ctx_h7",    "shape": [1,128],  "bits": 16, "device": "dram", "layer": 2},

    {"name": "attn_scores_h8", "shape": [1,2668], "bits": 16, "device": "dram", "layer": 2},
    {"name": "attn_probs_h8",  "shape": [1,2668], "bits": 16, "device": "dram", "layer": 2},
    {"name": "attn_ctx_h8",    "shape": [1,128],  "bits": 16, "device": "dram", "layer": 2},

    {"name": "attn_scores_h9", "shape": [1,2668], "bits": 16, "device": "dram", "layer": 2},
    {"name": "attn_probs_h9",  "shape": [1,2668], "bits": 16, "device": "dram", "layer": 2},
    {"name": "attn_ctx_h9",    "shape": [1,128],  "bits": 16, "device": "dram", "layer": 2},

    {"name": "attn_scores_h10","shape": [1,2668], "bits": 16, "device": "dram", "layer": 2},
    {"name": "attn_probs_h10", "shape": [1,2668], "bits": 16, "device": "dram", "layer": 2},
    {"name": "attn_ctx_h10",   "shape": [1,128],  "bits": 16, "device": "dram", "layer": 2},

    {"name": "attn_scores_h11","shape": [1,2668], "bits": 16, "device": "dram", "layer": 2},
    {"name": "attn_probs_h11", "shape": [1,2668], "bits": 16, "device": "dram", "layer": 2},
    {"name": "attn_ctx_h11",   "shape": [1,128],  "bits": 16, "device": "dram", "layer": 2},

    {"name": "attn_scores_h12","shape": [1,2668], "bits": 16, "device": "dram", "layer": 2},
    {"name": "attn_probs_h12", "shape": [1,2668], "bits": 16, "device": "dram", "layer": 2},
    {"name": "attn_ctx_h12",   "shape": [1,128],  "bits": 16, "device": "dram", "layer": 2},

    {"name": "attn_scores_h13","shape": [1,2668], "bits": 16, "device": "dram", "layer": 2},
    {"name": "attn_probs_h13", "shape": [1,2668], "bits": 16, "device": "dram", "layer": 2},
    {"name": "attn_ctx_h13",   "shape": [1,128],  "bits": 16, "device": "dram", "layer": 2},

    {"name": "attn_scores_h14","shape": [1,2668], "bits": 16, "device": "dram", "layer": 2},
    {"name": "attn_probs_h14", "shape": [1,2668], "bits": 16, "device": "dram", "layer": 2},
    {"name": "attn_ctx_h14",   "shape": [1,128],  "bits": 16, "device": "dram", "layer": 2},

    {"name": "attn_scores_h15","shape": [1,2668], "bits": 16, "device": "dram", "layer": 2},
    {"name": "attn_probs_h15", "shape": [1,2668], "bits": 16, "device": "dram", "layer": 2},
    {"name": "attn_ctx_h15",   "shape": [1,128],  "bits": 16, "device": "dram", "layer": 2},

    {"name": "attn_scores_h16","shape": [1,2668], "bits": 16, "device": "dram", "layer": 2},
    {"name": "attn_probs_h16", "shape": [1,2668], "bits": 16, "device": "dram", "layer": 2},
    {"name": "attn_ctx_h16",   "shape": [1,128],  "bits": 16, "device": "dram", "layer": 2},


    {"name": "attn_ctx_cat",   "shape": [1, 2048], "bits": 16, "device": "dram", "layer": 2},
    {"name": "attn_out",       "shape": [1, 2048], "bits": 16, "device": "dram", "layer": 2}
  ],

  "ops": [

  {
    "type": "ParallelOps",
    "branches": [
      {"type": "MatMul", "A": "token_pe_cur", "B": "W_q_0_h1",  "C": "Q_t_h1"},
      {"type": "MatMul", "A": "token_pe_cur", "B": "W_k_0_h1",  "C": "K_t_h1"},
      {"type": "MatMul", "A": "token_pe_cur", "B": "W_v_0_h1",  "C": "V_t_h1"},

      {"type": "MatMul", "A": "token_pe_cur", "B": "W_q_0_h2",  "C": "Q_t_h2"},
      {"type": "MatMul", "A": "token_pe_cur", "B": "W_k_0_h2",  "C": "K_t_h2"},
      {"type": "MatMul", "A": "token_pe_cur", "B": "W_v_0_h2",  "C": "V_t_h2"},

      {"type": "MatMul", "A": "token_pe_cur", "B": "W_q_0_h3",  "C": "Q_t_h3"},
      {"type": "MatMul", "A": "token_pe_cur", "B": "W_k_0_h3",  "C": "K_t_h3"},
      {"type": "MatMul", "A": "token_pe_cur", "B": "W_v_0_h3",  "C": "V_t_h3"},

      {"type": "MatMul", "A": "token_pe_cur", "B": "W_q_0_h4",  "C": "Q_t_h4"},
      {"type": "MatMul", "A": "token_pe_cur", "B": "W_k_0_h4",  "C": "K_t_h4"},
      {"type": "MatMul", "A": "token_pe_cur", "B": "W_v_0_h4",  "C": "V_t_h4"},

      {"type": "MatMul", "A": "token_pe_cur", "B": "W_q_0_h5",  "C": "Q_t_h5"},
      {"type": "MatMul", "A": "token_pe_cur", "B": "W_k_0_h5",  "C": "K_t_h5"},
      {"type": "MatMul", "A": "token_pe_cur", "B": "W_v_0_h5",  "C": "V_t_h5"},

      {"type": "MatMul", "A": "token_pe_cur", "B": "W_q_0_h6",  "C": "Q_t_h6"},
      {"type": "MatMul", "A": "token_pe_cur", "B": "W_k_0_h6",  "C": "K_t_h6"},
      {"type": "MatMul", "A": "token_pe_cur", "B": "W_v_0_h6",  "C": "V_t_h6"},

      {"type": "MatMul", "A": "token_pe_cur", "B": "W_q_0_h7",  "C": "Q_t_h7"},
      {"type": "MatMul", "A": "token_pe_cur", "B": "W_k_0_h7",  "C": "K_t_h7"},
      {"type": "MatMul", "A": "token_pe_cur", "B": "W_v_0_h7",  "C": "V_t_h7"},

      {"type": "MatMul", "A": "token_pe_cur", "B": "W_q_0_h8",  "C": "Q_t_h8"},
      {"type": "MatMul", "A": "token_pe_cur", "B": "W_k_0_h8",  "C": "K_t_h8"},
      {"type": "MatMul", "A": "token_pe_cur", "B": "W_v_0_h8",  "C": "V_t_h8"},

      {"type": "MatMul", "A": "token_pe_cur", "B": "W_q_0_h9",  "C": "Q_t_h9"},
      {"type": "MatMul", "A": "token_pe_cur", "B": "W_k_0_h9",  "C": "K_t_h9"},
      {"type": "MatMul", "A": "token_pe_cur", "B": "W_v_0_h9",  "C": "V_t_h9"},

      {"type": "MatMul", "A": "token_pe_cur", "B": "W_q_0_h10", "C": "Q_t_h10"},
      {"type": "MatMul", "A": "token_pe_cur", "B": "W_k_0_h10", "C": "K_t_h10"},
      {"type": "MatMul", "A": "token_pe_cur", "B": "W_v_0_h10", "C": "V_t_h10"},

      {"type": "MatMul", "A": "token_pe_cur", "B": "W_q_0_h11", "C": "Q_t_h11"},
      {"type": "MatMul", "A": "token_pe_cur", "B": "W_k_0_h11", "C": "K_t_h11"},
      {"type": "MatMul", "A": "token_pe_cur", "B": "W_v_0_h11", "C": "V_t_h11"},

      {"type": "MatMul", "A": "token_pe_cur", "B": "W_q_0_h12", "C": "Q_t_h12"},
      {"type": "MatMul", "A": "token_pe_cur", "B": "W_k_0_h12", "C": "K_t_h12"},
      {"type": "MatMul", "A": "token_pe_cur", "B": "W_v_0_h12", "C": "V_t_h12"},

      {"type": "MatMul", "A": "token_pe_cur", "B": "W_q_0_h13", "C": "Q_t_h13"},
      {"type": "MatMul", "A": "token_pe_cur", "B": "W_k_0_h13", "C": "K_t_h13"},
      {"type": "MatMul", "A": "token_pe_cur", "B": "W_v_0_h13", "C": "V_t_h13"},

      {"type": "MatMul", "A": "token_pe_cur", "B": "W_q_0_h14", "C": "Q_t_h14"},
      {"type": "MatMul", "A": "token_pe_cur", "B": "W_k_0_h14", "C": "K_t_h14"},
      {"type": "MatMul", "A": "token_pe_cur", "B": "W_v_0_h14", "C": "V_t_h14"},

      {"type": "MatMul", "A": "token_pe_cur", "B": "W_q_0_h15", "C": "Q_t_h15"},
      {"type": "MatMul", "A": "token_pe_cur", "B": "W_k_0_h15", "C": "K_t_h15"},
      {"type": "MatMul", "A": "token_pe_cur", "B": "W_v_0_h15", "C": "V_t_h15"},

      {"type": "MatMul", "A": "token_pe_cur", "B": "W_q_0_h16", "C": "Q_t_h16"},
      {"type": "MatMul", "A": "token_pe_cur", "B": "W_k_0_h16", "C": "K_t_h16"},
      {"type": "MatMul", "A": "token_pe_cur", "B": "W_v_0_h16", "C": "V_t_h16"}
      ]
    },

    {
    "type": "ParallelOps",
    "branches": [
      {"type": "MatMul", "A": "Q_t_h1",  "B": "K_cache_h1",  "C": "attn_scores_h1",  "transpose_B": true},
      {"type": "MatMul", "A": "Q_t_h2",  "B": "K_cache_h2",  "C": "attn_scores_h2",  "transpose_B": true},
      {"type": "MatMul", "A": "Q_t_h3",  "B": "K_cache_h3",  "C": "attn_scores_h3",  "transpose_B": true},
      {"type": "MatMul", "A": "Q_t_h4",  "B": "K_cache_h4",  "C": "attn_scores_h4",  "transpose_B": true},
      {"type": "MatMul", "A": "Q_t_h5",  "B": "K_cache_h5",  "C": "attn_scores_h5",  "transpose_B": true},
      {"type": "MatMul", "A": "Q_t_h6",  "B": "K_cache_h6",  "C": "attn_scores_h6",  "transpose_B": true},
      {"type": "MatMul", "A": "Q_t_h7",  "B": "K_cache_h7",  "C": "attn_scores_h7",  "transpose_B": true},
      {"type": "MatMul", "A": "Q_t_h8",  "B": "K_cache_h8",  "C": "attn_scores_h8",  "transpose_B": true},
      {"type": "MatMul", "A": "Q_t_h9",  "B": "K_cache_h9",  "C": "attn_scores_h9",  "transpose_B": true},
      {"type": "MatMul", "A": "Q_t_h10", "B": "K_cache_h10", "C": "attn_scores_h10", "transpose_B": true},
      {"type": "MatMul", "A": "Q_t_h11", "B": "K_cache_h11", "C": "attn_scores_h11", "transpose_B": true},
      {"type": "MatMul", "A": "Q_t_h12", "B": "K_cache_h12", "C": "attn_scores_h12", "transpose_B": true},
      {"type": "MatMul", "A": "Q_t_h13", "B": "K_cache_h13", "C": "attn_scores_h13", "transpose_B": true},
      {"type": "MatMul", "A": "Q_t_h14", "B": "K_cache_h14", "C": "attn_scores_h14", "transpose_B": true},
      {"type": "MatMul", "A": "Q_t_h15", "B": "K_cache_h15", "C": "attn_scores_h15", "transpose_B": true},
      {"type": "MatMul", "A": "Q_t_h16", "B": "K_cache_h16", "C": "attn_scores_h16", "transpose_B": true}
      ]
    },

    {
      "type": "ParallelOps",
      "branches": [
      {"type": "SoftmaxOp", "A": "attn_scores_h1",  "axis": -1, "C": "attn_probs_h1"},
      {"type": "SoftmaxOp", "A": "attn_scores_h2",  "axis": -1, "C": "attn_probs_h2"},
      {"type": "SoftmaxOp", "A": "attn_scores_h3",  "axis": -1, "C": "attn_probs_h3"},
      {"type": "SoftmaxOp", "A": "attn_scores_h4",  "axis": -1, "C": "attn_probs_h4"},
      {"type": "SoftmaxOp", "A": "attn_scores_h5",  "axis": -1, "C": "attn_probs_h5"},
      {"type": "SoftmaxOp", "A": "attn_scores_h6",  "axis": -1, "C": "attn_probs_h6"},
      {"type": "SoftmaxOp", "A": "attn_scores_h7",  "axis": -1, "C": "attn_probs_h7"},
      {"type": "SoftmaxOp", "A": "attn_scores_h8",  "axis": -1, "C": "attn_probs_h8"},
      {"type": "SoftmaxOp", "A": "attn_scores_h9",  "axis": -1, "C": "attn_probs_h9"},
      {"type": "SoftmaxOp", "A": "attn_scores_h10", "axis": -1, "C": "attn_probs_h10"},
      {"type": "SoftmaxOp", "A": "attn_scores_h11", "axis": -1, "C": "attn_probs_h11"},
      {"type": "SoftmaxOp", "A": "attn_scores_h12", "axis": -1, "C": "attn_probs_h12"},
      {"type": "SoftmaxOp", "A": "attn_scores_h13", "axis": -1, "C": "attn_probs_h13"},
      {"type": "SoftmaxOp", "A": "attn_scores_h14", "axis": -1, "C": "attn_probs_h14"},
      {"type": "SoftmaxOp", "A": "attn_scores_h15", "axis": -1, "C": "attn_probs_h15"},
      {"type": "SoftmaxOp", "A": "attn_scores_h16", "axis": -1, "C": "attn_probs_h16"}
      ]
    },

    {
      "type": "ParallelOps",
      "branches": [
      {"type": "MatMul", "A": "attn_probs_h1",  "B": "V_cache_h1",  "C": "attn_ctx_h1"},
      {"type": "MatMul", "A": "attn_probs_h2",  "B": "V_cache_h2",  "C": "attn_ctx_h2"},
      {"type": "MatMul", "A": "attn_probs_h3",  "B": "V_cache_h3",  "C": "attn_ctx_h3"},
      {"type": "MatMul", "A": "attn_probs_h4",  "B": "V_cache_h4",  "C": "attn_ctx_h4"},
      {"type": "MatMul", "A": "attn_probs_h5",  "B": "V_cache_h5",  "C": "attn_ctx_h5"},
      {"type": "MatMul", "A": "attn_probs_h6",  "B": "V_cache_h6",  "C": "attn_ctx_h6"},
      {"type": "MatMul", "A": "attn_probs_h7",  "B": "V_cache_h7",  "C": "attn_ctx_h7"},
      {"type": "MatMul", "A": "attn_probs_h8",  "B": "V_cache_h8",  "C": "attn_ctx_h8"},
      {"type": "MatMul", "A": "attn_probs_h9",  "B": "V_cache_h9",  "C": "attn_ctx_h9"},
      {"type": "MatMul", "A": "attn_probs_h10", "B": "V_cache_h10", "C": "attn_ctx_h10"},
      {"type": "MatMul", "A": "attn_probs_h11", "B": "V_cache_h11", "C": "attn_ctx_h11"},
      {"type": "MatMul", "A": "attn_probs_h12", "B": "V_cache_h12", "C": "attn_ctx_h12"},
      {"type": "MatMul", "A": "attn_probs_h13", "B": "V_cache_h13", "C": "attn_ctx_h13"},
      {"type": "MatMul", "A": "attn_probs_h14", "B": "V_cache_h14", "C": "attn_ctx_h14"},
      {"type": "MatMul", "A": "attn_probs_h15", "B": "V_cache_h15", "C": "attn_ctx_h15"},
      {"type": "MatMul", "A": "attn_probs_h16", "B": "V_cache_h16", "C": "attn_ctx_h16"}
      ]
    },

    {"type": "MatMul", "A": "attn_ctx_cat", "B": "W_o_0", "C": "attn_out"},
    {"type": "AddOp",  "A": "attn_out", "B": "token_pe_cur", "C": "attn_out"},
    {"type": "LayerNorm", "A": "attn_out", "C": "attn_out"},

    {"type": "UCIeOp", "size_bits": 32768} 
  ]
}
